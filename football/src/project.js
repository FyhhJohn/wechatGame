window.__require=function e(o,t,n){function c(a,s){if(!t[a]){if(!o[a]){var r=a.split("/");if(r=r[r.length-1],!o[r]){var l="function"==typeof __require&&__require;if(!s&&l)return l(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+a+"'")}}var d=t[a]={exports:{}};o[a][0].call(d.exports,function(e){return c(o[a][1][e]||e)},d,d.exports,e,o,t,n)}return t[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)c(n[a]);return c}({Touch:[function(e,o,t){"use strict";cc._RF.push(o,"0b314+bKq1KoaWaRO/ASGaa","Touch"),cc.Class({extends:cc.Component,properties:{_isTouch:!1},onLoad:function(){this.node.once(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.once(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.once(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancle,this)},onTouchStart:function(e){this._isTouch=!0},onTouchCancle:function(){this._isTouch=!1},onTouchEnd:function(e){if(this._isTouch){var o=this.node.position,t=this.node.parent;cc.loader.loadRes("prefabs/explosion",function(e,n){if(e)cc.log("explosion err");else{var c=cc.instantiate(n);c.position=o,c.parent=t}}),this._isTouch=!1,this.node.destroy()}}}),cc._RF.pop()},{}],ball:[function(e,o,t){"use strict";cc._RF.push(o,"430e9KsXN9CvbEu0Jio6Ylw","ball"),cc.Class({extends:cc.Component,properties:{_isEnterDoor:!1},onLoad:function(){},onCollisionEnter:function(e,o){if(!(t=o.node.getComponent("ball"))._isEnterDoor)if("star"==e.node.group)e.node.getComponent("star").Destroy();else if("door"==e.node.group)cc.systemEvent.emit("gameWin"),t._isEnterDoor=!0;else if("wall"==e.node.group){var t;(t=o.node.parent.getComponent(cc.RigidBody)).linearVelocity=cc.v2(0,0),t.angularVelocity=0,window.poolManager.put(o.node.parent)}},onCollisionExit:function(e,o){},enterDoor:function(){cc.log("enterDoor"),this.node.runAction(cc.fadeTo(.1,100),cc.callFunc(function(){this.node.removeComponent(cc.PhysicsCircleCollider),this.node.removeComponent(cc.CircleCollider)}))},onDestroy:function(){}}),cc._RF.pop()},{}],boomEffect:[function(e,o,t){"use strict";cc._RF.push(o,"bc249KCyuxKAaMex/ST8IFd","boomEffect"),cc.Class({extends:cc.Component,properties:{boomValue:200},onLoad:function(){var e=this.node.getComponent(cc.Animation);e.play("boomEffect"),e.on("finished",this.onFinishedCallback,this)},onCollisionEnter:function(e,o){if("ball"==e.node.group){var t=o.node.getComponent("boomEffect").getForceVec(e.node.parent,o.node),n=e.node.parent.getComponent(cc.RigidBody);n.linearVelocity=cc.v2(t.x+n.linearVelocity.x,t.y+n.linearVelocity.y)}},getForceVec:function(e,o){var t=e.position.sub(o.position);return t=t.normalize().mul(this.boomValue)},onFinishedCallback:function(){this.node.destroy()}}),cc._RF.pop()},{}],boom:[function(e,o,t){"use strict";cc._RF.push(o,"c9c03gyR1NDXLGu4q83p6EJ","boom"),cc.Class({extends:cc.Component,properties:{boomValue:200},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this)},onTouchStart:function(){var e=this,o=this.node.position,t=this.node.parent;cc.loader.loadRes("prefabs/boomEffect",function(n,c){if(n)cc.log("boomEffect err");else{var i=cc.instantiate(c);i.getComponent("boomEffect").boomValue=e.boomValue,i.position=o,i.parent=t}}),this.node.destroy()}}),cc._RF.pop()},{}],dataManager:[function(e,o,t){"use strict";cc._RF.push(o,"997793HRBRGuq1MWiLzmX0P","dataManager"),window.PAGE_COUNT=1,window.STAGE_COUNT=14,window.PAGE_STAGE_PER_COUNT=STAGE_COUNT/PAGE_COUNT,window.STAGE_LINE_COUNT=2;var n=cc.Class({name:"dataManager",properties:{curLevel:1,starNum:0,stageInfo:null},ctor:function(){},getStageInfo:function(){if(null==this.stageInfo){var e=cc.sys.localStorage.getItem("stageInfo");cc.log("--------stageInfo---------"),cc.log(e),this.stageInfo=null==e||e=={}||""==e?{1:0}:JSON.parse(e)}return this.stageInfo},saveStageInfo:function(){cc.sys.localStorage.setItem("stageInfo",JSON.stringify(this.stageInfo))},updateStageInfo:function(e,o){(null==this.stageInfo[e]||null!=this.stageInfo[e]&&this.stageInfo[e]<o)&&(this.stageInfo[e]=o,e+1<window.STAGE_COUNT&&(this.stageInfo[e+1]||(this.stageInfo[e+1]=0)),this.saveStageInfo())}});window.dataManager=new n,cc._RF.pop()},{}],gameUI:[function(e,o,t){"use strict";cc._RF.push(o,"4cd491QYzhNt7RZC4cjdh6j","gameUI"),cc.Class({extends:cc.Component,properties:{level:cc.Label,starList:[cc.Sprite],starSF:cc.SpriteFrame,starEffect:cc.Prefab,winNode:cc.Node,winStarNum:cc.Sprite,winStarSF:[cc.SpriteFrame],levleNode:cc.Node,_starCount:0},onLoad:function(){this.winNode.active=!1,this.setLevel()},onEnable:function(){cc.systemEvent.on("updateStar",this.updateStar,this),cc.systemEvent.on("gameWin",this.gameWin,this)},onDestroy:function(){cc.systemEvent.off("updateStar",this.updateStar,this),cc.systemEvent.off("gameWin",this.gameWin,this)},setLevel:function(){this.level.string="Level\uff1a"+window.dataManager.curLevel},updateStar:function(){cc.log("updateStar"),this._starCount++;for(var e=this._starCount-1;e<this._starCount;e++){this.starList[e].spriteFrame=this.starSF;var o=cc.instantiate(this.starEffect);o.getComponent(cc.Animation).on("finished",function(){o.destroy()}),o.position=this.starList[e].node.position,o.parent=this.starList[e].node.parent}},gameWin:function(){cc.log("\u606d\u559c\u8fc7\u5173"),window.dataManager.updateStageInfo(window.dataManager.curLevel,this._starCount),this.winNode.active=!0,this.winStarNum.spriteFrame=this.winStarSF[this._starCount]},reAgainBtnClicked:function(){cc.director.loadScene("game")},nextGameBtnClicked:function(){window.dataManager.curLevel<window.STAGE_COUNT?(window.dataManager.curLevel+=1,cc.director.loadScene("game")):cc.director.loadScene("level")},backBtnClicked:function(){cc.director.loadScene("level")}}),cc._RF.pop()},{}],levelUI:[function(e,o,t){"use strict";cc._RF.push(o,"74759anlohAILcdKxKuWiqC","levelUI"),cc.Class({extends:cc.Component,properties:{stagePrefab:cc.Prefab,pageView:cc.PageView,pageItem:cc.Node,_stageList:[],_pageList:[cc.Node]},onLoad:function(){this.addStage(),this.initStageInfo()},onBtnBackClicked:function(){cc.director.loadScene("main")},addStage:function(){for(var e=0;e<window.PAGE_COUNT;e++){for(var o=cc.instantiate(this.pageItem),t=window.STAGE_COUNT*e;t<window.STAGE_COUNT*(e+1);t++){var n=cc.instantiate(this.stagePrefab);n.parent=o,this._stageList[t]=n}o.parent=this.pageView.content,o.active=!0,this._pageList[e]=o}},initStageInfo:function(){for(var e=this,o=window.dataManager.getStageInfo(),t=function(){var t={id:n+1,star:0,isOpen:!0};null!=o[n+1]?(t.star=o[n+1],t.isOpen=!0):(t.star=0,t.isOpen=!1),e._stageList[n].getComponent("stage").initStageInfo(t,function(){window.dataManager.curLevel=t.id,cc.director.loadScene("game")})},n=0;n<window.STAGE_COUNT;n++)t()}}),cc._RF.pop()},{}],level:[function(e,o,t){"use strict";cc._RF.push(o,"a35a5e+sZlCD5CWM4sS1oHM","level"),cc.Class({extends:cc.Component,properties:{ball:cc.Prefab,door:cc.Prefab,spring:cc.Prefab,square:cc.Prefab,star:cc.Prefab,triangle:cc.Prefab,road1:cc.Prefab},onLoad:function(){this.init()},init:function(){var e=this,o="json/levelNode_"+window.dataManager.curLevel;cc.loader.loadRes(o,function(o,t){o?cc.log("load json err"):(cc.log(t.json),e.initObj(t.json))})},initObj:function(e){for(var o=0;o<e.length;o++){var t=e[o],n=window.poolManager.get(t.name);if(n.position=cc.v2(t.x,t.y),n.scaleX=t.scaleX,n.scaleY=t.scaleY,n.angle=t.angle,t.dir&&t.moveDis&&t.moveTime)n.addComponent("moveAct").move(t.dir,t.moveDis,t.moveTime);t.forceValue&&(n.getComponent("spring").forceValue=t.forceValue),t.boomValue&&(n.getComponent("boom").boomValue=t.boomValue),n.parent=this.node}}}),cc._RF.pop()},{}],mainUI:[function(e,o,t){"use strict";cc._RF.push(o,"6c654HHgNlFxIAODhEgh4FK","mainUI"),cc.Class({extends:cc.Component,properties:{ballPrefab:cc.Prefab,physicNode:cc.Node},onLoad:function(){window.poolManager.initPool(),this.schedule(function(){this.createBall()},1)},btnPlayClicked:function(){cc.director.loadScene("level")},createBall:function(){var e=window.poolManager.get("ball"),o=Math.random()>.5?1:-1,t=o*cc.winSize.width/2,n=Math.random()*cc.winSize.height/2,c=(300*Math.random()+300)*-o,i=200*Math.random()*-1,a=(150*Math.random()+150)*-o;e.position=cc.v2(t,n),e.getComponent(cc.RigidBody).linearVelocity=cc.v2(c,i),e.getComponent(cc.PhysicsCircleCollider).restitution=.9,e.getComponent(cc.RigidBody).angularVelocity=a,e.parent=this.physicNode},editorClicked:function(){cc.director.loadScene("editor")}}),cc._RF.pop()},{}],moveAct:[function(e,o,t){"use strict";cc._RF.push(o,"21138imRDxGCbePL6UAwFvR","moveAct"),cc.Class({extends:cc.Component,properties:{dir:0,moveDis:0,moveTime:.5},onLoad:function(){},move:function(e,o,t){0!=e&&(this.dir=e,this.moveDis=o,this.moveTime=t,1==this.dir?this.node.runAction(cc.repeatForever(cc.sequence(cc.moveBy(this.moveTime,-this.moveDis,0),cc.moveBy(2*this.moveTime,2*this.moveDis,0),cc.moveBy(this.moveTime,-this.moveDis,0)))):this.node.runAction(cc.repeatForever(cc.sequence(cc.moveBy(this.moveTime,0,-this.moveDis),cc.moveBy(2*this.moveTime,0,2*this.moveDis),cc.moveBy(this.moveTime,0,-this.moveDis)))))}}),cc._RF.pop()},{}],physics:[function(e,o,t){"use strict";cc._RF.push(o,"d2b2cZlg7ZDEKvhZn28PcG5","physics"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.director.getPhysicsManager().enabled=!0;var e=cc.director.getCollisionManager();e.enabled=!0}}),cc._RF.pop()},{}],poolManager:[function(e,o,t){"use strict";cc._RF.push(o,"a370buq4XpLaJESeXk1sH2u","poolManager");var n=cc.Class({properties:{_poolList:null,_isInit:!1},ctor:function(){},initPool:function(){var e=this;this._isInit||(this._ballPool=new cc.NodePool,cc.loader.loadRes("prefabs/ball",function(o,t){if(o)cc.log(" ball error ");else{e.ballPre=t;for(var n=0;n<20;n++){var c=cc.instantiate(t);e._ballPool.put(c)}}}),this._road1Pool=new cc.NodePool,cc.loader.loadRes("prefabs/road1",function(o,t){if(o)cc.log(" road1 error ");else{e.road1Pre=t;for(var n=0;n<5;n++){var c=cc.instantiate(t);e._road1Pool.put(c)}}}),this._road3Pool=new cc.NodePool,cc.loader.loadRes("prefabs/road3",function(o,t){if(o)cc.log(" road3 error ");else{e.road3Pre=t;for(var n=0;n<5;n++){var c=cc.instantiate(t);e._road3Pool.put(c)}}}),this._springPool=new cc.NodePool,cc.loader.loadRes("prefabs/spring",function(o,t){if(o)cc.log(" spring error ");else{e.springPre=t;for(var n=0;n<5;n++){var c=cc.instantiate(t);e._springPool.put(c)}}}),this._squarePool=new cc.NodePool,cc.loader.loadRes("prefabs/square",function(o,t){if(o)cc.log(" square error ");else{e.squarePre=t;for(var n=0;n<20;n++){var c=cc.instantiate(t);e._squarePool.put(c)}}}),this._starPool=new cc.NodePool,cc.loader.loadRes("prefabs/star",function(o,t){if(o)cc.log(" star error ");else{e.starPre=t;for(var n=0;n<5;n++){var c=cc.instantiate(t);e._starPool.put(c)}}}),this._starEffectPool=new cc.NodePool,cc.loader.loadRes("prefabs/star_effect",function(o,t){if(o)cc.log(" star_effect error ");else{e.star_effectPre=t;for(var n=0;n<5;n++){var c=cc.instantiate(t);e._starEffectPool.put(c)}}}),this._starEffec2tPool=new cc.NodePool,cc.loader.loadRes("prefabs/star_effect2",function(o,t){if(o)cc.log(" star_effect2 error ");else{e.star_effect2=t;for(var n=0;n<5;n++){var c=cc.instantiate(t);e._starEffec2tPool.put(c)}}}),this._trianglePool=new cc.NodePool,cc.loader.loadRes("prefabs/triangle",function(o,t){if(o)cc.log(" triangle error ");else{e.trianglePre=t;for(var n=0;n<20;n++){var c=cc.instantiate(t);e._trianglePool.put(c)}}}),this._doorPool=new cc.NodePool,cc.loader.loadRes("prefabs/door",function(o,t){if(o)cc.log(" door error ");else{e.doorPre=t;for(var n=0;n<20;n++){var c=cc.instantiate(t);e._doorPool.put(c)}}}),this._boomPool=new cc.NodePool,cc.loader.loadRes("prefabs/boom",function(o,t){if(o)cc.log(" boom error ");else{e.boomPre=t;for(var n=0;n<20;n++){var c=cc.instantiate(t);e._boomPool.put(c)}}}),this._isInit=!0,this._poolList={ball:this._ballPool,road1:this._road1Pool,road3:this._road3Pool,spring:this._springPool,square:this._squarePool,star:this._starPool,star_effect:this._starEffectPool,star_effect2:this._starEffec2tPool,triangle:this._trianglePool,door:this._doorPool,boom:this._boomPool})},get:function(e){var o=this._poolList[e],t=null;return null!=o&&(t=o.size()>0?o.get():cc.instantiate(this[e+"Pre"])),t},put:function(e){var o=this._poolList[e.name];null!=o&&o.put(e)},releaseAll:function(){for(var e in this._poolList)this._poolList[e].clear()}});window.poolManager=new n,cc._RF.pop()},{}],spring:[function(e,o,t){"use strict";cc._RF.push(o,"97c63T7KGNJnIxZgQjWfNOe","spring"),cc.Class({extends:cc.Component,properties:{forceValue:500,_forceVec:cc.v2(0,0)},onLoad:function(){0==this.node.angle?this._forceVec=cc.v2(0,this.forceValue):this.node.angle>0?this._forceVec=cc.v2(-this.forceValue,0):this.node.angle<0&&(this._forceVec=cc.v2(this.forceValue,0)),this._ani=this.node.getComponent(cc.Animation)},onCollisionEnter:function(e,o){if(console.log("on collision enter"),"ball"==e.node.group){var t=o.node.getComponent("spring");t.playAnimation();var n=e.node.parent.getComponent(cc.RigidBody);e.node.parent.runAction(cc.sequence(cc.delayTime(.05),cc.callFunc(function(){n.linearVelocity=cc.v2(t._forceVec.x+n.linearVelocity.x,t._forceVec.y+n.linearVelocity.y)})))}},playAnimation:function(){cc.log(" playAnimation "),this._ani.play("spring")}}),cc._RF.pop()},{}],stage:[function(e,o,t){"use strict";cc._RF.push(o,"8d231XjXIpMWKTk+1yFj0zi","stage"),cc.Class({extends:cc.Component,properties:{starSP:cc.Sprite,starFrame:[cc.SpriteFrame],text:cc.Label,btnStage:cc.Button},onLoad:function(){},initStageInfo:function(e,o){this.starSP.spriteFrame=this.starFrame[e.star],this.btnStage.interactable=e.isOpen,this.text.string=""+e.id,this.text.node.active=e.isOpen,this._callback=o},onStageClicked:function(){this._callback&&this._callback()}}),cc._RF.pop()},{}],star_effect:[function(e,o,t){"use strict";cc._RF.push(o,"23557juWUtPDoRPsm4nGlcU","star_effect"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){var e=this.node.getComponent(cc.Animation);e.play("star_effect"),e.on("finished",this.onfinished,this)},onfinished:function(){cc.log("\u83b7\u5f97\u4e00\u661f"),this.node.destroy()}}),cc._RF.pop()},{}],star:[function(e,o,t){"use strict";cc._RF.push(o,"35aefKKA89Ha7M70u6Hve4d","star"),cc.Class({extends:cc.Component,properties:{effect:cc.Prefab},onLoad:function(){},Destroy:function(){var e=cc.instantiate(this.effect);e.parent=this.node.parent,e.position=this.node.position,this.node.getComponent("moveAct")&&this.node.removeComponent("moveAct"),window.poolManager.put(this.node),cc.systemEvent.emit("updateStar")}}),cc._RF.pop()},{}]},{},["Touch","gameUI","levelUI","mainUI","ball","boom","boomEffect","level","dataManager","poolManager","moveAct","physics","spring","stage","star","star_effect"]);